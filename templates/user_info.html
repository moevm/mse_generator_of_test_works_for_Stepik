<html>
<head>
    <meta charset="utf-8">
    <title>Страница пользователя</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user_info.css') }}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
</head>
<body>
<div class="user-page">
    <div class="form">
        <form class="user-form" action="{{ url_for('course') }}" method="GET">
            <div class="logout-button">
                <a href={{ url_for('logout') }}>
                    <img id="logout" src="../static/icons/logout_icon.png" width="48px" height="48px">
                </a>
            </div>
            <div class="user-name">
                <h4>
                    Hello,
                </h4>
                <h3 name="user_name">
                    {{ name }}
                </h3>
            </div>
            <div class="input-group mb-3" id="course-selection">
                <select name="id" class="custom-select" id="inputGroupSelect02">
                    <option selected value="">Choose...</option>
                    {% for course in courses %}
                        <option value="{{ course['id'] }}">{{ course['title'] }}</title></option>
                    {% endfor %}
                </select>
                <div class="input-group-append">
                    <label class="input-group-text" for="inputGroupSelect02">Courses</label>
                </div>
                <div id="buttons">
                    <button type="submit" id="select-button">Генерация контрольной</button>
                    <button id="select-button2">Учебный план</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    $(document).ready(function(){
        $('#select-button2').on('click', function () {
            $.get('/plan');
        });

        $(".user-form").submit(function(e) {
            if (!checkCourseLoad()) {
                e.preventDefault();
            }
        });

        function checkCourseLoad() {
            let isLoaded = false;
            $.ajax({
                url: `/check?id=${$('#inputGroupSelect02').val()}`,
                type: 'GET',
                success: function (data) {
                    isLoaded = true;
                    if (data.isSave) {

                    }
                },
                error: function () {
                    alert('error');
                },
            });
            return isLoaded;
        }
    });
</script>
</body>
</html>